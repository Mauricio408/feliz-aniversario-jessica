<!DOCTYPE html>
<html>
  <head>
    <title>Feliz Anivers√°rio, Jessica Moz√£o! - AR</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    
    <!-- Bibliotecas AR (AR.js e A-Frame) -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://raw.githack.com/fcor/arjs-gestures/master/dist/gestures.js"></script>

    <style>
      /* Estilos para a tela inicial (overlay) */
      #overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.9); z-index: 9999;
        display: flex; justify-content: center; align-items: center; flex-direction: column;
        color: white; font-family: 'Inter', sans-serif; text-align: center;
      }
      .btn {
        margin-top: 30px; padding: 14px 30px; background: #FF33A1; /* Rosa choque */
        border-radius: 8px; font-weight: bold; cursor: pointer;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        transition: background-color 0.3s;
      }
      .btn:hover {
        background: #ef2d5e;
      }
    </style>
  </head>

  <body style="margin: 0; overflow: hidden;">
    
    <!-- 1. Componente de Intera√ß√£o de Surpresa A-Frame -->
    <script>
      // Componente que lida com o clique/toque para gerar um efeito de vibra√ß√£o e mudan√ßa de cor
      AFRAME.registerComponent('surprise-interaction', {
        init: function () {
          var el = this.el;
          el.addEventListener('click', function () {
            
            // 1. Feedback de clique/toque: Anima√ß√£o de escala (vibra√ß√£o)
            el.setAttribute('animation__click', {
                property: 'scale',
                from: '1.2 1.2 1.2', 
                to: '1.4 1.4 1.4',
                dur: 150,
                dir: 'alternate',
                startEvents: 'click' 
            });
            setTimeout(() => el.removeAttribute('animation__click'), 300);
            
            // 2. L√≥gica de Mudan√ßa de Cor (Efeito Surpresa)
            const newColor = '#FF33A1'; // Novo Rosa Choque

            // Mudar a cor do texto
            const textEntity = el.querySelector('[text]');
            if (textEntity) {
                textEntity.setAttribute('text', 'color', newColor); 
            } else if (el.components.text) {
                el.setAttribute('text', 'color', newColor);
            }
            
            // Mudar a cor do objeto 3D
            if (el.nodeName === 'A-ICOSAHEDRON') {
                el.setAttribute('color', newColor); 
            }
          });
        }
      });
    </script>
    
    <!-- Tela de In√≠cio (overlay) -->
    <div id="overlay">
      <div style="font-size: 32px; font-weight: bold;">Surpresa AR de Anivers√°rio!</div>
      <div style="margin-top: 20px; font-size: 18px; color: #ccc;">Encontre os 3 marcadores (Hiro, A, B) para a mensagem completa.</div>
      <div class="btn">TOQUE PARA INICIAR O AMOR</div>
    </div>

    <a-scene
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
      renderer="logarithmicDepthBuffer: true; colorManagement: true;"
      vr-mode-ui="enabled: false"
      gesture-detector
      id="scene"
    >

      <a-assets>
        <!-- ‚ö†Ô∏è M√öSICA DE FUNDO: O link direto do YouTube (Xd800esKfb8) n√£o funciona como fonte de √°udio. 
             A m√∫sica √© "Soft and Soulful üé∂ 60s Love Songs..." (Timeless Love).
             Voc√™ deve encontrar ou hospedar a vers√£o MP3/WAV e SUBSTITUIR o URL abaixo. -->
        <audio id="music" src="https://example.com/substitua_pelo_audio_mp3_aqui.mp3" preload="auto"></audio>
      </a-assets>

      <!-- Toca a m√∫sica ap√≥s o clique no overlay (se a URL for v√°lida) -->
      <a-sound src="#music" autoplay="true" loop="true" volume="0.5" id="background-music"></a-sound>

      <!-- 1. MARCador HIRO: Frase de Abertura (Com Fundo e Anima√ß√£o El√°stica) -->
      <a-marker preset="hiro">
        <a-entity 
          position="0 1.2 0" 
          rotation="-90 0 0" 
          scale="0.001 0.001 0.001" 
          surprise-interaction
          gesture-handler
        >
          <!-- Fundo semitransparente para melhorar a leitura -->
          <a-plane 
            width="4.5" 
            height="1.5" 
            color="#000000" 
            opacity="0.6" 
            position="0 0 -0.01" 
            shader="standard"
            material="metalness: 0.1; roughness: 0.8;"></a-plane>
            
          <!-- Texto da Abertura -->
          <a-entity
            text="value: Jessica, meu amor, a vida com voc√™ √© a celebra√ß√£o mais linda. Feliz 26 anos! Este √© o primeiro passo da nossa surpresa. ‚ù§Ô∏è; align: center; width: 4; color: #FFFFFF; font: exo2bold;"
            position="0 0 0"
          ></a-entity>
          
          <!-- Anima√ß√£o de escala (Surgimento El√°stico) -->
          <a-animation 
            attribute="scale" 
            from="0.001 0.001 0.001" 
            to="1.5 1.5 1.5" 
            dur="2500" 
            easing="easeOutElastic" 
            repeat="0"
          ></a-animation>
        </a-entity>
      </a-marker>

      <!-- 2. MARCADOR A: Cora√ß√£o 3D (O Ponto Focal) -->
      <a-marker preset="letterA">
        <a-icosahedron 
          position="0 1.5 0" 
          radius="0.8" 
          color="#FF0055" 
          material="shader: standard; metalness: 0.8; roughness: 0.1;"
          surprise-interaction
          gesture-handler
          
          <!-- Anima√ß√£o de Rota√ß√£o Cont√≠nua -->
          animation="property: rotation; to: 360 360 360; loop: true; dur: 10000; easing: linear;"
          
          <!-- Anima√ß√£o de Pulsar (Scale Alternate) -->
          animation__pulse="property: scale; from: 1 1 1; to: 1.1 1.1 1.1; dir: alternate; loop: true; dur: 1500;"
        >
          <!-- Texto Flutuante no Cora√ß√£o -->
          <a-entity
            text="value: VOC√ä √â O MEU PRESENTE. (Clique e Sinta o Amor!); align: center; width: 3; color: #FFFFFF; font: exo2bold;"
            position="0 0.2 0"
            rotation="0 0 0"
            scale="0.5 0.5 0.5"
          ></a-entity>
        </a-icosahedron>
      </a-marker>

      <!-- 3. MARCADOR B: Frase de Conclus√£o (Com Fundo e Anima√ß√£o de Rota√ß√£o) -->
      <a-marker preset="letterB">
        <a-entity 
          position="0 1.2 0" 
          rotation="-90 0 0" 
          scale="1.2 1.2 1.2" 
          surprise-interaction
          gesture-handler
        >
          <!-- Fundo semitransparente -->
          <a-plane 
            width="4.5" 
            height="1.5" 
            color="#000000" 
            opacity="0.6" 
            position="0 0 -0.01"
            shader="standard"
            material="metalness: 0.1; roughness: 0.8;"></a-plane>
            
          <!-- Texto da Conclus√£o -->
          <a-entity
            text="value: Obrigado por ser a luz, a aventura e o conforto do meu mundo. Que venham mais 26 anos ao seu lado. Eu te amo, para sempre. ‚ú®; align: center; width: 4; color: #EFEF00; font: exo2bold;"
            position="0 0 0"
          ></a-entity>
          
          <!-- Anima√ß√£o de rota√ß√£o sutil -->
          <a-animation 
            attribute="rotation" 
            to="-90 10 -5" 
            dir="alternate" 
            loop="true" 
            dur="4000"
          ></a-animation>
        </a-entity>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      // L√≥gica do Bot√£o de In√≠cio (Para habilitar a c√¢mera e o √°udio)
      const overlay = document.getElementById('overlay');
      overlay.addEventListener('click', function() {
        overlay.style.display = 'none';
        
        // Tenta retomar o contexto de √°udio (necess√°rio para que a m√∫sica toque em navegadores modernos)
        try {
          const AudioContext = window.AudioContext || window.webkitAudioContext;
          if (AudioContext) {
            const context = new AudioContext();
            context.resume().then(() => console.log('Audio Context resumed'));
          }
        } catch (e) {
          console.error("N√£o foi poss√≠vel retomar o contexto de √°udio:", e);
        }
      });
    </script>
  </body>
</html>
